.NOLIST

#include	"ti83plus.inc"
#include	"mirage.inc"
; #define	ProgStart	$9D95
.LIST

	.org	$9d93		;Origin (set back two to account for AsmPrgm)
	.db	$BB,$6D			;Compiled AsmPrgm token
	ret					;So TIOS wont run the program
	.db	1				;Identifier as MirageOS program
	.db %00000000,%00000000
	.db %00000000,%00000000
	.db %00001100,%00000000
	.db %00010010,%00000000
	.db %00001100,%00000000
	.db %00011111,%00000000
	.db %01100001,%10000000
	.db %01100001,%01000000
	.db %10011110,%00000000
	.db %00011011,%00000011
	.db %00110001,%11000100
	.db %00010000,%00001011
	.db %00001000,%00000100
	.db %11111111,%00011111
	.db %00000001,%00010000
Description:	.db	"mirageos_test",0	
prog_start:
	LD BC,3
	LD (ct),BC
kloop:
	b_call(_ClrLCDFull)
	CALL clear_screen
	call load_sprite
	LD     HL, picdata
	LD     DE, PlotSScreen
	LD     BC, 64*12
	LDIR                      
	b_call(_GrBufCpy)
	
	b_call(_GetKey)
	CP kRight
	JR Z,move_right
	CP kLeft
	JR Z,move_left
	; CP kUp
	; JR Z,move_up
	; CP kDown
	; JR Z,move_down
	CP kClear
	JR NZ,kloop
	
	CALL clear_screen
	RET
	
move_right:
	LD BC,(posx)
	LD A,C
	CP 255
	JR Z,kloop
	INC BC
	LD (posx),BC
	JR kloop
	
move_left:
	LD BC,(posx)
	LD A,C
	CP 0
	JR Z,kloop
	DEC BC
	LD (posx),BC
	JR kloop
	
move_up:
	LD BC,(posy)
	DEC BC
	LD (posy),BC
	JR kloop
	
move_down:
	LD BC,(posy)
	INC BC
	LD (posy),BC
	JR kloop
	

clear_screen:
	LD BC,12*64
_clear_screen_loop:
	LD HL,picdata
	ADD HL,BC
	LD (HL),$00
	DEC BC
	LD H,B
	LD L,C
	LD DE,0
	SBC HL,DE
	JR NZ,_clear_screen_loop
	LD HL,picdata
	LD (HL),$00
	RET
	
	
;endian, reverse data
load_sprite: ;make into loop
	LD DE,(imgsprite)
	LD B,E
	LD C,D
	LD HL,picdata ; + (12*posy)+posx
	
	
	;;
	; PUSH BC
	; LD BC,(posy)
	; LD A,12
	; call mult8
	; LD B,0
	; LD C,A
	; ADD HL,BC
	; POP BC
	;;
	LD DE,(posx)
	ADD HL,DE
	
	LD (HL),B
	LD DE,12
	ADD HL,DE
	LD (HL),C
	
	
	;;;;;;;
	
	
	LD DE,(imgsprite+2)
	LD B,E
	LD C,D
	LD HL,picdata + 24
	
	;;
	; PUSH BC
	; LD BC,(posy)
	; LD A,12
	; call mult8
	; LD B,0
	; LD C,A
	; ADD HL,BC
	; POP BC
	;;
	LD DE,(posx)
	ADD HL,DE
	
	LD (HL),B
	LD DE,12
	ADD HL,DE
	LD (HL),C
	
	;;;;;;;;
	
	LD DE,(imgsprite+4)
	LD B,E
	LD C,D
	LD HL,picdata + 48
	
	;;
	; PUSH BC
	; LD BC,(posy)
	; LD A,12
	; call mult8
	; LD B,0
	; LD C,A
	; ADD HL,BC
	; POP BC
	;;
	LD DE,(posx)
	ADD HL,DE

	
	LD (HL),B
	LD DE,12
	ADD HL,DE
	LD (HL),C
	
	RET
	
	
	
#include "CLib.inc"
ct:	.DB $00,$00
posx: .DB 3
posy: .DB 0000b


imgsprite:
	.DB %10000001 
	.DB %11000011
	.DB %11100111 
	.DB %11111111
	.DB %11100111 
	.DB %11000011


; LD BC,(imgsprite+2)
; LD H,C
; LD L,B
; b_call(_DispHL)

; LD BC,(imgsprite+4)
; LD H,C
; LD L,B
; b_call(_DispHL)

	
; 96×64
picdata: ;12x64 bytes
    .DB    0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b
    .DB    0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b
    .DB    0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b
    .DB    0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b
    .DB    0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b
    .DB    0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b
    .DB    0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b
    .DB    0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b
    .DB    0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b
    .DB    0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b
    .DB    0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b
    .DB    0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b
    .DB    0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b
    .DB    0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b
    .DB    0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b
    .DB    0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b
	
    .DB    0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b
    .DB    0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b
    .DB    0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b
    .DB    0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b
    .DB    0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b
    .DB    0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b
    .DB    0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b
    .DB    0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b
    .DB    0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b
    .DB    0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b
    .DB    0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b
    .DB    0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b
    .DB    0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b
    .DB    0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b
    .DB    0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b
    .DB    0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b
	
    .DB    0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b
    .DB    0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b
    .DB    0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b
    .DB    0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b
    .DB    0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b
    .DB    0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b
    .DB    0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b
    .DB    0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b
    .DB    0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b
    .DB    0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b
    .DB    0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b
    .DB    0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b
    .DB    0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b
    .DB    0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b
    .DB    0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b
    .DB    0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b
	
    .DB    0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b
    .DB    0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b
    .DB    0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b
    .DB    0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b
    .DB    0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b
    .DB    0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b
    .DB    0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b
    .DB    0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b
    .DB    0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b
    .DB    0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b
    .DB    0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b
    .DB    0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b
    .DB    0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b
    .DB    0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b
    .DB    0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b
    .DB    0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b, 0000 0000b
	
.end
.end